var VENDER=function(){var a=navigator.userAgent;return-1!=a.indexOf("WebKit")?"webkit":"Gecko"==navigator.product?"Moz":-1!=a.indexOf("Opera")?"O":""}();function Basic(){}Basic.init=function(a){Basic.SetterAndGetterEscape.prototype={};var b=new Basic,c;for(c in b)a.__proto__[c]=b[c];b=a.__proto__;for(c in b);return a};
Basic.prototype={extend:function(a){var b=new a,c={},d;for(d in this.__proto__)c[d]=this.__proto__[d],Basic.SetterAndGetterEscape.prototype[d]=this.__proto__[d];for(d in b)this.__proto__[d]=b[d],Basic.SetterAndGetterEscape.prototype[d]=a.prototype[d];b=Basic.SetterAndGetterEscape.prototype;for(d in b)try{void 0!=b[d].get&&this.__defineGetter__(d,b[d].get),void 0!=b[d].set&&this.__defineSetter__(d,b[d].set)}catch(e){}Basic.SetterAndGetterEscape.prototype={};for(var f in c)this.__proto__[f]=c[f];this.__serialID=
this.___serialID();this.extendsFlag=!0;a==Sprite&&(this.extend(DisplayObject),this._element=new this.createElement("div"),this._style.position="absolute")}};Basic.SetterAndGetterEscape=function(){};Basic.SetterAndGetterEscape.prototype={___serialID:function(){return Math.floor(1E12*Math.random())}};Basic.imagePool=new Image;function EventDispatcher(){this.enterFrameFlag=!1;var a=this._registEveArry={};a.obj=[];a.ID=[];a.handler=[];a.method=[]}
EventDispatcher.prototype={addEventListener:function(a,b,c){var d=this._registEveArry;d.obj.push(c);d.ID.push(this.__serialID);d.handler.push(a);d.method.push(b);"enterframe"==a&&this.__onEnterFrame__();if("touchend"==a||"touchmove"==a||"click"==a||"mousemove"==a||"mouseover"==a||"mousedown"==a)this._element.__this=this,this._element.__obj=c,this._element.__handler=a,this._element.__method=b,this._element.addEventListener(a,this.__mouseAndTouchHandler,!0)},dispatchEvent:function(a){var b=this._registEveArry,
c,d=!1;"object"==typeof a?(c=a.type,d=!0):c=a;var e=this.__removeCount(b,c);if(-1!=e)b.obj[e][b.method[e]](d?a:{target:this,type:c})},removeEventListener:function(a){if("enterframe"==a)this.removeEnterFrame();else{var b=this._registEveArry,c=this.__removeCount(b,a);-1!=c&&(b.obj.splice(c,1),b.handler.splice(c,1),b.method.splice(c,1),("touchend"==a||"touchmove"==a||"click"==a||"mousemove"==a||"mouseover"==a||"mousedown"==a)&&this._element.removeEventListener(a,this.__mouseAndTouchHandler,!0))}},__removeCount:function(a,
b){for(var c=-1,d=a.handler,e=a.ID,f=0;f<d.length;f++)if(d[f]==b&&e[f]==this.__serialID){c=f;break}return c},__mouseAndTouchHandler:function(a){var b={},c;for(c in a)b[c]=a[c];a=a.target;void 0==a.__this&&(a=a.parentNode);b.target=a.__this;b.type=a.__handler;a.__obj[a.__method](b)},___serialID:function(){return Math.floor(1E12*Math.random())}};function BEvent(a,b){return{type:a,target:b}}
function DisplayObject(){Basic.init(this).extend(EventDispatcher);this.fps=Stage.fps;this._nID;this.extendsFlag||this.__onEnterFrame__();this._element=new this.createElement("div");this._element.style.position="absolute";this._children=[];this.__transformRotation=this.__transformScale=""}
DisplayObject.prototype={_scene:{get:function(){return this.__scene},set:function(a){this.__scene=a}},createElement:function(a){return document.createElement(a)},removeEnterFrame:function(){clearInterval(this._nID)},_element:{get:function(){this.__element||(this.__element=new this.createElement("div"));return this.__element},set:function(a){this.__element=a}},_style:{get:function(){return this._element.style},set:function(a){this._element.style=a}},id:{get:function(){this._element.id||(this._element.id=
"");return this._element.id},set:function(a){this._element.id=a}},className:{get:function(){this._element.className||(this._element.className="");return this._element.className},set:function(a){this._element.className=a}},x:{get:function(){this._x||(this._x=0);return this._x},set:function(a){this._style.left=a+"px";this._x=a}},y:{get:function(){this._y||(this._y=0);return this._y},set:function(a){this._style.top=a+"px";this._y=a}},width:{get:function(){this._width||(this._width=0);return this._width},
set:function(a){this._style.width=a+"px";this._width=a}},height:{get:function(){this._height||(this._height=0);return this._height},set:function(a){this._style.height=a+"px";this._height=a}},__transform__:function(){this._style[VENDER+"Transform"]=this.__transformScale+" "+this.__transformRotation},scale:{get:function(){void 0==this._scaleX&&(this._scaleX=1);void 0==this._scaleY&&(this._scaleY=1);return this._scaleX},set:function(a){this._scaleY=this._scaleX=a;this.__transformScale="scale("+a+","+
a+")";this.__transform__(!0)}},scaleX:{get:function(){void 0==this._scaleX&&(this._scaleX=1);return this._scaleX},set:function(a){this._scaleX=a;this.__transformScale="scale("+this.scaleX+","+this.scaleY+")";this.__transform__(!0)}},scaleY:{get:function(){void 0==this._scaleY&&(this._scaleY=1);return this._scaleY},set:function(a){this._scaleY=a;this.__transformScale="scale("+this.scaleX+","+this.scaleY+")";this.__transform__(!0)}},visible:{get:function(){this._visible||(this._visible=!0);return this._visible},
set:function(a){this._visible=a;this._style.visibility=a?"visible":"hidden"}},alpha:{get:function(){""==this._style.opacity&&(this._alpha=this._style.opacity=1);return this._alpha},set:function(a){this._alpha=this._style.opacity=a}},rotation:{get:function(){this._rotation||(this._rotation=0);return this._rotation},set:function(a){this._rotation=a;this.__transformRotation="rotate("+this._rotation+"deg)";this.__transform__(!0)}},image:{get:function(){return this._image},set:function(a){this._image=
{};for(var b=0;b<stage.assets.length;b++)if(stage.assets[b].key==a){var c="";switch(stage.assets[b].base64.substring(0,3)){case "R0l":c="gif";break;case "iVB":c="png";break;case "/9j":c="jpg"}var d=Basic.imagePool;d.img=stage.assets[b];d.src="data:image/"+c+";base64,"+d.img.base64;this._image.src=d.src;var e=this;d.onload=function(){e._image.width=d.width;e._image.height=d.height};this._style.backgroundImage="url("+d.src+")"}}},frame:{get:function(){this._frame||(this._frame=0);return this._frame},
set:function(a){this._frame=a;this._style.backgroundPosition=String(-Math.floor(this._frame*this._width)+"px 0")}},addChild:function(a){try{this._element.appendChild(a._element)}catch(b){var c=document.getElementById(this._element.id);trace(c);c.appendChild(a._element)}this._scene&&(a._scene=this._scene);a.parent=this;this._children.push(a)},removeChild:function(a){this._element.removeChild(a._element)},removeChildAt:function(a){try{this._element.removeChild(this._element.childNodes[a])}catch(b){trace("childlen undefined")}},
numChildren:{get:function(){return this._element.childNodes.length}},swapChildren:function(a,b){this.parent._element.insertBefore(a._element,b._element)},addChildThreejsContent:function(a){a.init();return a},removeChildThreejsContent:function(a){a.remove()},__clear__:function(){var a=this._children;try{for(var b=0;b<a.length;b++)if(void 0!=a[b]._scene&&this._scene==a[b]._scene)try{this.removeChild(a[b]),a[b]._scene=null,a[b].parent=null,a[b].__clear__(),delete a[b]._scene,delete a[b].parent,delete a[b]}catch(c){}}catch(d){trace("__clear__",
this,d)}this._children=[]}};function Sprite(a,b){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this._element.style.position="absolute";this.width=a;this.height=b;this._children=[]}
Sprite.prototype={__onEnterFrame__:function(){var a=this;this._nID=setInterval(function(){a.onEnterFrame()},1E3/stage.fps)},onEnterFrame:function(){null!=this._scene?this.dispatchEvent(this._scene.ENTER_FRAME):this.dispatchEvent("enterframe")},mask:{get:function(){return this._mask},set:function(a){this._image?a?(this._style[VENDER+"MaskImage"]="url("+this._image.src+")",this._style.backgroundImage="none"):(this._style[VENDER+"MaskImage"]="none",this._style.backgroundImage="url("+this._image.src+
")"):this._style.overflow=a?"hidden":"visible";this._mask=a}}};function TextField(a,b){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this._element.style.position="absolute";this.width=a;this.height=b;this._children=[]}
TextField.prototype={text:{get:function(){this._text||(this._text="");return this._text},set:function(a){this._text=a;this._element.innerHTML=a}},selectable:{get:function(){this._selectable||(this._selectable=!1);return this._selectable},set:function(a){this._selectable=a;this._style[VENDER+"UserSelect"]=a?"text":"none"}}};
function Stage(a,b){Basic.init(this).extend(Sprite);this._element=document.getElementById("stage");this._sceneStorage=[];this.fps=60;this._element.style.width=a+"px";this._element.style.height=b+"px";this._element.style.overflow="hidden";this.width=a;this.height=b;this.__onloadFlag=!1}Stage.fps=60;
Stage.prototype={currentScene:function(){return this._sceneStorage[this._sceneStorage.length-1]},pushScene:function(a){this._sceneStorage.push(a);var b=this._sceneStorage.length;2<=b&&(b=this._sceneStorage[b-2],b.stop(),this.removeChild(b));a._element.className=a._sceneName;this.addChild(a);a.start()},popScene:function(){},removeScene:function(a){for(var b=0;b<this._sceneStorage.length;b++)this._sceneStorage[b]==a&&this._sceneStorage.splice(b,1);a.__clear__();delete null},assets:[],preload:function(a){var b=
this;if("string"!=typeof a){this.loadFileLength=a.length;for(var c=this.loadFileCount=0;c<a.length;c++)Basic.Ajax({},"GET",a[c],!0,function(a,c){b.assets.push({key:c,base64:window.btoa(a.replace(/[\u0100-\uffff]/g,function(a){return String.fromCharCode(a.charCodeAt(0)&255)}))});if(b.loadFileLength==b.loadFileCount+1&&!b.__onloadFlag){new stage.onload;b.__onloadFlag=true}b.loadFileCount++})}else Basic.Ajax({},"GET",a,!0,function(a,c){b.assets.push({key:c,base64:window.btoa(a.replace(/[\u0100-\uffff]/g,
function(a){return String.fromCharCode(a.charCodeAt(0)&255)}))});if(!b.__onloadFlag){stage.onload();b.__onloadFlag=true}})},start:function(){}};function Scene(a){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this.ENTER_FRAME="_enterframe";this._element.style.position="relative";a?this._sceneName=a:(this._sceneName="Scene"+Scene.number,Scene.number++);this._children=[]}Scene.number=0;
Scene.prototype={start:function(){trace(this._sceneName,"start()");this.ENTER_FRAME="enterframe"},stop:function(){trace(this._sceneName,"stop()");this.ENTER_FRAME="_enterframe"},addChild:function(a){this._element.appendChild(a._element);a.parent=this;a._scene=this;this._children.push(a);a=a._children;try{for(var b=0;b<a.length;b++){a[b]._scene=this;for(var c=a[b]._children,d=0;d<c.length;d++){c[d]._scene=this;for(var e=c[d]._children,f=0;f<e.length;f++){e[f]._scene=this;for(var g=e[f]._children,h=
0;h<g.length;h++)g[h]._scene=this}}}}catch(j){trace(j)}},removeChild:function(a){this._element.removeChild(a._element);for(i=0;i<this._children.length;i++)this._children[i]==a&&(trace("scene delete obj",a),this._children.splice(i,1));a._scene=null;delete a._scene}};
function Timer(a,b){Basic.init(this).extend(EventDispatcher);Timer.COMPLETE="complete";Timer.PAUSE="pause";Timer.TIMER="timer";this._timerFlag=!1;this._msecTime=a;this._counter=0;b?this._loopCount=b:this._loopCount;0==b&&(this._loopFlag=!0)}
Timer.prototype={start:function(){var a=this;a._timerFlag=!0;this.nID=setInterval(function(){a._msecTime>10*a._counter&&a._timerFlag?a._counter++:a._loopFlag?(a._counter=0,a.dispatchEvent(Timer.TIMER)):0<a._loopCount?(a._counter=0,a.dispatchEvent(Timer.TIMER),a._loopCount--):(clearInterval(a.nID),a.stop())},10)},pause:function(){clearInterval(this.nID);this.dispatchEvent(Timer.PAUSE)},stop:function(){this._timerFlag=!1;this.dispatchEvent(Timer.COMPLETE)}};
Basic.Ajax=function(a,b,c,d,e,f){var g=new XMLHttpRequest;g.open(b,c,d);g.param=c;g.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");g.overrideMimeType("text/plain; charset=x-user-defined");g.onreadystatechange=function(){if(4==g.readyState)if((g.getResponseHeader("Content-Type")||"").match(/^image/),"string"!=typeof e)e(g.responseText,g.param);else f[e](g.responseText,g.param)};var b="",h;for(h in a)""!=b&&(b+="&"),b+=h+"="+a[h];g.send(b)};
function on_loaded(a){res=a;console.log(res)}function trace(a){2<=arguments.length?console.log(arguments):console.log(a);console.trace()}function Import(a){var b=document.createElement("script");b.src=a;b.charset="UTF-8";document.getElementsByTagName("head")[0].appendChild(b)}function FpsView(){this._fr=stage.fps;this.init()}
FpsView.prototype={init:function(){var a=new Stats;a.getDomElement().style.position="absolute";a.getDomElement().style.left="0px";a.getDomElement().style.top="0px";stage._element.appendChild(a.getDomElement());setInterval(function(){stage.rialTimeFps=a.update()},1E3/this._fr)}};