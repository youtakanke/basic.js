/*! 
 * Basic.js JavaScript Library v1.0.0 
 * 
 * Copyright 2012, k-factory, yota kanke 
 * Dual licensed under the MIT or GPL Version 2 licenses. 
 * https://github.com/youtakanke/basic.js 
 * 
 * Blog http://kf-plvs-vltra.com/blog/
 */
var VENDER=function(){var a=navigator.userAgent;return-1!=a.indexOf("WebKit")?"webkit":"Gecko"==navigator.product?"Moz":-1!=a.indexOf("Opera")?"O":""}();function Basic(){}Basic.init=function(a){Basic.SetterAndGetterEscape.prototype={};var b=new Basic,d;for(d in b)a.__proto__[d]=b[d];b=a.__proto__;for(d in b);return a};
Basic.prototype={extend:function(a){var b=new a,d={},c;for(c in this.__proto__)d[c]=this.__proto__[c],Basic.SetterAndGetterEscape.prototype[c]=this.__proto__[c];for(c in b)this.__proto__[c]=b[c],Basic.SetterAndGetterEscape.prototype[c]=a.prototype[c];a=Basic.SetterAndGetterEscape.prototype;for(c in a)try{if(b.__lookupGetter__(c)){var e=b.__lookupGetter__(c);this.__defineGetter__(c,e);this.__proto__[c]=null;delete this.__proto__[c]}if(b.__lookupSetter__(c)){var g=b.__lookupSetter__(c);this.__defineSetter__(c,
g);this.__proto__[c]=null;delete this.__proto__[c]}void 0!=a[c].get&&this.__defineGetter__(c,a[c].get);void 0!=a[c].set&&this.__defineSetter__(c,a[c].set)}catch(f){}Basic.SetterAndGetterEscape.prototype={};for(var h in d)this.__proto__[h]=d[h];this.__serialID=this.___serialID();this.extendsFlag=!0;this._element&&(this._element=new this.createElement("div"),this._style.position="absolute")}};Basic.SetterAndGetterEscape=function(){};
Basic.SetterAndGetterEscape.prototype={___serialID:function(){return Math.floor(1E12*Math.random())}};Basic.imagePool=new Image;function EventDispatcher(){this.enterFrameFlag=!1;var a=this._registEveArry={};a.obj=[];a.ID=[];a.handler=[];a.method=[]}
EventDispatcher.prototype={addEventListener:function(a,b,d){var c=this._registEveArry;c.obj.push(d);c.ID.push(this.__serialID);c.handler.push(a);c.method.push(b);"enterframe"==a&&this.__onEnterFrame__();if("touchend"==a||"touchstart"==a||"touchmove"==a||"click"==a||"mousemove"==a||"mouseover"==a||"mousedown"==a)this._element.__this=this,this._element.__obj=d,this._element.__handler=a,this._element.__method=b,this._element.addEventListener(a,this.__mouseAndTouchHandler,!0)},dispatchEvent:function(a){var b=
this._registEveArry,d,c=!1;"object"==typeof a?(d=a.type,c=!0):d=a;var e=this.__removeCount(b,d);if(-1!=e)b.obj[e][b.method[e]](c?a:{target:this,type:d})},removeEventListener:function(a){if("enterframe"==a)this.removeEnterFrame();else{var b=this._registEveArry,d=this.__removeCount(b,a);-1!=d&&(b.obj.splice(d,1),b.handler.splice(d,1),b.method.splice(d,1),("touchend"==a||"touchstart"==a||"touchmove"==a||"click"==a||"mousemove"==a||"mouseover"==a||"mousedown"==a)&&this._element.removeEventListener(a,
this.__mouseAndTouchHandler,!0))}},__removeCount:function(a,b){for(var d=-1,c=a.handler,e=a.ID,g=0;g<c.length;g++)if(c[g]==b&&e[g]==this.__serialID){d=g;break}return d},__mouseAndTouchHandler:function(a){var b={},d;for(d in a)b[d]=a[d];a=a.target;void 0==a.__this&&(a=a.parentNode);b.target=a.__this;b.type=a.__handler;a.__obj[a.__method](b)},___serialID:function(){return Math.floor(1E12*Math.random())}};function BEvent(a,b){return{type:a,target:b}}
function DisplayObject(){Basic.init(this).extend(EventDispatcher);this.fps=Stage.fps;this._nID;this.extendsFlag||this.__onEnterFrame__();this._element=new this.createElement("div");this._element.style.position="absolute";this._children=[];this.__transformRotation=this.__transformScale=""}
DisplayObject.prototype={_scene:{get:function(){return this.__scene},set:function(a){this.__scene=a}},createElement:function(a){return document.createElement(a)},removeEnterFrame:function(){clearInterval(this._nID)},_element:{get:function(){this.__element||(this.__element=new this.createElement("div"));return this.__element},set:function(a){this.__element=a}},_style:{get:function(){return this._element.style},set:function(a){this._element.style=a}},id:{get:function(){this._element.id||(this._element.id=
"");return this._element.id},set:function(a){this._element.id=a}},className:{get:function(){this._element.className||(this._element.className="");return this._element.className},set:function(a){this._element.className=a}},x:{get:function(){this._x||(this._x=0);return this._x},set:function(a){this._style.left=a+"px";this._x=a}},y:{get:function(){this._y||(this._y=0);return this._y},set:function(a){this._style.top=a+"px";this._y=a}},width:{get:function(){this._width||(this._width=0);return this._width},
set:function(a){this._style.width=a+"px";this._width=a}},height:{get:function(){this._height||(this._height=0);return this._height},set:function(a){this._style.height=a+"px";this._height=a}},__transform__:function(){this._style[VENDER+"Transform"]=this.__transformScale+" "+this.__transformRotation},scale:{get:function(){void 0==this._scaleX&&(this._scaleX=1);void 0==this._scaleY&&(this._scaleY=1);return this._scaleX},set:function(a){this._scaleY=this._scaleX=a;this.__transformScale="scale("+a+","+
a+")";this.__transform__(!0)}},scaleX:{get:function(){void 0==this._scaleX&&(this._scaleX=1);return this._scaleX},set:function(a){this._scaleX=a;this.__transformScale="scale("+this.scaleX+","+this.scaleY+")";this.__transform__(!0)}},scaleY:{get:function(){void 0==this._scaleY&&(this._scaleY=1);return this._scaleY},set:function(a){this._scaleY=a;this.__transformScale="scale("+this.scaleX+","+this.scaleY+")";this.__transform__(!0)}},visible:{get:function(){this._visible||(this._visible=!0);return this._visible},
set:function(a){this._visible=a;this._style.visibility=a?"visible":"hidden"}},alpha:{get:function(){""==this._style.opacity&&(this._alpha=this._style.opacity=1);return this._alpha},set:function(a){this._alpha=this._style.opacity=a}},rotation:{get:function(){this._rotation||(this._rotation=0);return this._rotation},set:function(a){this._rotation=a;this.__transformRotation="rotate("+this._rotation+"deg)";this.__transform__(!0)}},image:{get:function(){return this._image},set:function(a){this._image=
{};for(var b=!1,d=0;d<stage.assets.length;d++)if(stage.assets[d].key==a){b="";switch(stage.assets[d].base64.substring(0,3)){case "R0l":b="gif";break;case "iVB":b="png";break;case "/9j":b="jpg"}var c=Basic.imagePool;c.img=stage.assets[d];c.src="data:image/"+b+";base64,"+c.img.base64;this._image.src=c.src;var e=this;c.onload=function(){e._image.width=c.width;e._image.height=c.height};this._style.backgroundImage="url("+c.src+")";b=!0}b||console.warn("not match image path = ",a)}},frame:{get:function(){this._frame||
(this._frame=0);return this._frame},set:function(a){this._frame=a;this._style.backgroundPosition=String(-Math.floor(this._frame*this._width)+"px 0")}},addChild:function(a){try{a._style[VENDER+"UserSelect"]="none",this._element.appendChild(a._element)}catch(b){var d=document.getElementById(this._element.id);trace(d);d.appendChild(a._element)}this._scene&&(a._scene=this._scene);a.parent=this;this._children.push(a)},removeChild:function(a){this._element.removeChild(a._element)},removeChildAt:function(a){try{this._element.removeChild(this._element.childNodes[a])}catch(b){trace("childlen undefined")}},
numChildren:{get:function(){return this._element.childNodes.length}},swapChildren:function(a,b){this.parent._element.insertBefore(a._element,b._element)},addChildThreejsContent:function(a){a.init();return a},removeChildThreejsContent:function(a){a.remove()},__clear__:function(){var a=this._children;try{for(var b=0;b<a.length;b++)if(void 0!=a[b]._scene&&this._scene==a[b]._scene)try{this.removeChild(a[b]),a[b]._scene=null,a[b].parent=null,a[b].__clear__(),delete a[b]._scene,delete a[b].parent,delete a[b]}catch(d){}}catch(c){trace("__clear__",
this,c)}this._children=[]}};function Sprite(a,b){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this._element.style.position="absolute";this.width=a;this.height=b;this._children=[]}
Sprite.prototype={__onEnterFrame__:function(){var a=this;this._nID=setInterval(function(){a.onEnterFrame()},1E3/stage.fps)},onEnterFrame:function(){null!=this._scene?this.dispatchEvent(this._scene.ENTER_FRAME):this.dispatchEvent("enterframe")},mask:{get:function(){return this._mask},set:function(a){this._image?a?(this._style[VENDER+"MaskImage"]="url("+this._image.src+")",this._style.backgroundImage="none"):(this._style[VENDER+"MaskImage"]="none",this._style.backgroundImage="url("+this._image.src+
")"):this._style.overflow=a?"hidden":"visible";this._mask=a}}};function TextField(a,b){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this._element.style.position="absolute";this.width=a;this.height=b;this._children=[]}
TextField.prototype={text:{get:function(){this._text||(this._text="");return this._text},set:function(a){this._text=a;this._element.innerHTML=a}},selectable:{get:function(){this._selectable||(this._selectable=!1);return this._selectable},set:function(a){this._selectable=a;this._style[VENDER+"UserSelect"]=a?"text":"none"}}};
function Stage(a,b){Basic.init(this).extend(Sprite);this._element=document.getElementById("stage");this._sceneStorage=[];this.fps=60;this._element.style.width=a+"px";this._element.style.height=b+"px";this._element.style.overflow="hidden";this.width=a;this.height=b;this.__onloadFlag=!1}Stage.fps=60;
Stage.prototype={currentScene:function(){return this._sceneStorage[this._sceneStorage.length-1]},pushScene:function(a){this._sceneStorage.push(a);var b=this._sceneStorage.length;2<=b&&(b=this._sceneStorage[b-2],b.stop(),this.removeChild(b));a._element.className=a._sceneName;this.addChild(a);a.start();a.__start__()},popScene:function(){},removeScene:function(a){for(var b=0;b<this._sceneStorage.length;b++)this._sceneStorage[b]==a&&this._sceneStorage.splice(b,1);a.__clear__();delete null},assets:[],
preload:function(a){var b=this;if("string"!=typeof a){this.loadFileLength=a.length;for(var d=this.loadFileCount=0;d<a.length;d++)Basic.Ajax({},"GET",a[d],!0,function(a,d){b.assets.push({key:d,base64:window.btoa(a.replace(/[\u0100-\uffff]/g,function(a){return String.fromCharCode(a.charCodeAt(0)&255)}))});b.loadFileLength==b.loadFileCount+1&&!b.__onloadFlag&&(new stage.onload,b.__onloadFlag=!0);b.loadFileCount++})}else Basic.Ajax({},"GET",a,!0,function(a,d){b.assets.push({key:d,base64:window.btoa(a.replace(/[\u0100-\uffff]/g,
function(a){return String.fromCharCode(a.charCodeAt(0)&255)}))});b.__onloadFlag||(stage.onload(),b.__onloadFlag=!0)})},start:function(){}};function Scene(a){Basic.init(this).extend(DisplayObject);this._element=new this.createElement("div");this.ENTER_FRAME="_enterframe";this._element.style.position="relative";a?this._sceneName=a:(this._sceneName="Scene"+Scene.number,Scene.number++);this._children=[]}Scene.number=0;
Scene.prototype={start:function(){trace(this._sceneName,"start()")},__start__:function(){this.ENTER_FRAME="enterframe"},stop:function(){trace(this._sceneName,"stop()");this.ENTER_FRAME="_enterframe"},addChild:function(a){a._style[VENDER+"UserSelect"]="none";this._element.appendChild(a._element);a.parent=this;a._scene=this;this._children.push(a);a=a._children;try{for(var b=0;b<a.length;b++){a[b]._scene=this;for(var d=a[b]._children,c=0;c<d.length;c++){d[c]._scene=this;for(var e=d[c]._children,g=0;g<
e.length;g++){e[g]._scene=this;for(var f=e[g]._children,h=0;h<f.length;h++)f[h]._scene=this}}}}catch(j){trace(j)}},removeChild:function(a){this._element.removeChild(a._element);for(i=0;i<this._children.length;i++)this._children[i]==a&&(trace("scene delete obj",a),this._children.splice(i,1));a._scene=null;delete a._scene}};
function Timer(a,b){Basic.init(this).extend(EventDispatcher);Timer.COMPLETE="complete";Timer.PAUSE="pause";Timer.TIMER="timer";this._timerFlag=!1;this._msecTime=a;this._counter=0;b?this._loopCount=b:this._loopCount;0==b&&(this._loopFlag=!0)}
Timer.prototype={start:function(){var a=this;a._timerFlag=!0;this.nID=setInterval(function(){a._msecTime>10*a._counter&&a._timerFlag?a._counter++:a._loopFlag?(a._counter=0,a.dispatchEvent(Timer.TIMER)):0<a._loopCount?(a._counter=0,a.dispatchEvent(Timer.TIMER),a._loopCount--):(clearInterval(a.nID),a.stop())},10)},pause:function(){clearInterval(this.nID);this.dispatchEvent(Timer.PAUSE)},stop:function(){this._timerFlag=!1;this.dispatchEvent(Timer.COMPLETE)}};
Basic.Ajax=function(a,b,d,c,e,g){var f=new XMLHttpRequest;f.open(b,d,c);f.param=d;f.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");f.overrideMimeType("text/plain; charset=x-user-defined");f.onreadystatechange=function(){if(4==f.readyState)if((f.getResponseHeader("Content-Type")||"").match(/^image/),"string"!=typeof e)e(f.responseText,f.param);else g[e](f.responseText,f.param)};b="";for(var h in a)""!=b&&(b+="&"),b+=h+"="+a[h];f.send(b)};
function on_loaded(a){res=a;console.log(res)}function trace(a){2<=arguments.length?console.log(arguments):console.log(a);console.trace()}function Import(a){var b=document.createElement("script");b.src=a;b.charset="UTF-8";document.getElementsByTagName("head")[0].appendChild(b)}function FpsView(){this._fr=stage.fps;this.init()}
FpsView.prototype={init:function(){var a=new Stats;a.getDomElement().style.position="absolute";a.getDomElement().style.left="0px";a.getDomElement().style.top="0px";stage._element.appendChild(a.getDomElement());setInterval(function(){stage.rialTimeFps=a.update()},1E3/this._fr)}};